<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <title>Teste de API - Gerenciamento de Hotel</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        padding: 20px;
        background-color: #f4f4f4;
      }
      h2 {
        border-bottom: 2px solid #ccc;
        padding-bottom: 5px;
      }
      .section {
        background-color: #fff;
        padding: 15px;
        margin-bottom: 20px;
        border-radius: 5px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }
      input[type="text"],
      input[type="password"],
      input[type="number"],
      input[type="date"] {
        padding: 8px;
        margin-right: 10px;
        border: 1px solid #ddd;
        border-radius: 3px;
      }
      button {
        padding: 10px 15px;
        background-color: #007bff;
        color: white;
        border: none;
        border-radius: 3px;
        cursor: pointer;
      }
      button:hover {
        background-color: #0056b3;
      }
      pre {
        background-color: #eee;
        padding: 10px;
        border-radius: 3px;
        white-space: pre-wrap;
        word-wrap: break-word;
      }
      .token-display {
        font-size: 14px;
        font-weight: bold;
        color: #28a745;
        margin-top: 10px;
      }
    </style>
  </head>
  <body>
    <h1>API Hotel - Teste de Funcionalidades</h1>

    <div class="section">
      <h2>üîí 1. Autentica√ß√£o (Login)</h2>
      <input
        type="text"
        id="email"
        placeholder="Email (admin@hotel.com)"
        value="admin@hotel.com"
      />
      <input
        type="password"
        id="password"
        placeholder="Senha (senhaforte123)"
        value="senhaforte123"
      />
      <button onclick="login()">Login e Obter Token</button>
      <div class="token-display">
        Token JWT: <span id="current-token">N/A</span>
      </div>
      <pre id="auth-output">Sa√≠da da Requisi√ß√£o...</pre>
    </div>

    <div class="section">
      <h2>üë® 2. Clientes (CRUD Completo)</h2>
      <input
        type="number"
        id="cliente-id-input"
        placeholder="ID (Para Edi√ß√£o/Excluir)"
        value=""
      />

      <input
        type="text"
        id="cliente-nome"
        placeholder="Nome"
        value="H√≥spede de Teste"
      />
      <input
        type="text"
        id="cliente-cpf"
        placeholder="CPF"
        value="111.111.111-11"
      />
      <input
        type="text"
        id="cliente-telefone"
        placeholder="Telefone"
        value="999999999"
      />
      <input
        type="text"
        id="cliente-email"
        placeholder="Email"
        value="hospede_novo@hotel.com"
      />
      <br /><br />

      <button onclick="createCliente()">1. Criar Cliente (POST)</button>
      <button onclick="listClientes()">2. Listar Todos (GET)</button>
      <button onclick="getOneCliente()">3. Buscar por ID (GET /:id)</button>
      <button onclick="updateCliente()">4. Editar por ID (PUT /:id)</button>
      <button onclick="deleteCliente()">5. Excluir por ID (DELETE /:id)</button>

      <div class="token-display">
        ID Cliente Criado/Atualizado: <span id="cliente-id">N/A</span>
      </div>
      <pre id="cliente-output">Sa√≠da da Requisi√ß√£o...</pre>
    </div>

    <div class="section">
      <h2>üè® 3. Gerenciamento de Quartos (CRUD Completo)</h2>

      <input
        type="number"
        id="quarto-id-input"
        placeholder="ID (Para Edi√ß√£o/Excluir)"
        value=""
      />
      <input
        type="text"
        id="quarto-numero"
        placeholder="N√∫mero (Ex: 101)"
        value="101"
      />
      <select id="quarto-tipo">
        <option value="Solteiro">Solteiro</option>
        <option value="Duplo" selected>Duplo</option>
        <option value="Casal">Casal</option>
        <option value="Suite">Su√≠te</option>
      </select>
      <input
        type="number"
        id="quarto-valor"
        placeholder="Valor Di√°ria"
        value="150.00"
      />
      <input
        type="number"
        id="quarto-capacidade"
        placeholder="Capacidade"
        value="2"
      />
      <select id="quarto-status-edit">
        <option value="Dispon√≠vel" selected>Dispon√≠vel</option>
        <option value="Ocupado">Ocupado</option>
        <option value="Manuten√ß√£o">Manuten√ß√£o</option>
      </select>
      <br /><br />

      <button onclick="createQuarto()">1. Criar Quarto (POST)</button>
      <button onclick="listQuartos()">2. Listar Todos (GET)</button>
      <button onclick="getOneQuarto()">3. Buscar por ID (GET /:id)</button>
      <button onclick="updateQuarto()">4. Editar por ID (PUT /:id)</button>
      <button onclick="deleteQuarto()">5. Excluir por ID (DELETE /:id)</button>

      <div class="token-display">
        ID Quarto Criado/Atualizado: <span id="quarto-id">N/A</span>
      </div>
      <pre id="quarto-output">Sa√≠da da Requisi√ß√£o...</pre>
    </div>

    <div class="section">
      <h2>üìÖ 4. Criar e Gerenciar Reservas (CRUD B√°sico)</h2>

      <h3>Fazer Nova Reserva (POST /api/reservas)</h3>
      <input
        type="number"
        id="reserva-clienteId"
        placeholder="ID do Cliente (Ex: 15)"
        value="15"
      />
      <input
        type="number"
        id="reserva-quartoId"
        placeholder="ID do Quarto (Ex: 10)"
        value="10"
      />
      <label for="reserva-checkIn">Check-In:</label>
      <input type="date" id="reserva-checkIn" value="2025-12-01" />

      <label for="reserva-checkOut">Check-Out:</label>
      <input type="date" id="reserva-checkOut" value="2025-12-04" />
      <br /><br />

      <button onclick="createReserva()">1. Criar Reserva (POST)</button>
      <button onclick="listReservas()">2. Listar Todas (GET)</button>

      <hr style="margin: 15px 0" />

      <h3>Gerenciar por ID (GET/DELETE /api/reservas/:id)</h3>
      <input
        type="number"
        id="reserva-id-input"
        placeholder="ID da Reserva (Ex: 1)"
        value=""
      />
      <button onclick="getOneReserva()">3. Buscar por ID (GET)</button>
      <button onclick="deleteReserva()" style="background-color: #dc3545">
        4. Excluir por ID (DELETE)
      </button>

      <div class="token-display">
        ID Reserva Criada: <span id="reserva-id">N/A</span>
      </div>
      <pre id="reserva-output">Sa√≠da da Requisi√ß√£o...</pre>
    </div>

    <script>
      const BASE_URL = "http://localhost:3000/api";
      let CURRENT_TOKEN = localStorage.getItem("jwtToken") || "";
      let CLIENTE_ID = localStorage.getItem("clienteId") || "";
      let QUARTO_ID = localStorage.getItem("quartoId") || "";

      document.getElementById("current-token").textContent =
        CURRENT_TOKEN || "N/A";
      document.getElementById("cliente-id").textContent = CLIENTE_ID || "N/A";
      document.getElementById("quarto-id").textContent = QUARTO_ID || "N/A";

      // Helper para requisi√ß√µes protegidas
      async function fetchProtected(url, method, body = null) {
        // 1. Determina qual elemento de sa√≠da (output) usar baseado na URL
        let outputElementId;
        if (url.includes("/clientes")) {
          outputElementId = "cliente-output";
        } else if (url.includes("/quartos")) {
          outputElementId = "quarto-output";
        } else if (url.includes("/reservas")) {
          outputElementId = "reserva-output";
        } else if (url.includes("/auth")) {
          outputElementId = "auth-output";
        } else {
          outputElementId = "auth-output"; // Fallback
        }

        const outputElement = document.getElementById(outputElementId);
        if (!outputElement) {
          console.error("Elemento de sa√≠da n√£o encontrado:", outputElementId);
          return;
        }

        outputElement.textContent = "Carregando...";

        if (
          !CURRENT_TOKEN &&
          !url.includes("/auth/register") &&
          !url.includes("/auth/login")
        ) {
          outputElement.textContent =
            "ERRO: Fa√ßa o login primeiro para obter o token.";
          return;
        }

        // 2. Monta as op√ß√µes da requisi√ß√£o
        const options = {
          method: method,
          headers: {
            "Content-Type": "application/json",
            // Inclui o token apenas se ele existir e a rota n√£o for de autentica√ß√£o
            ...(CURRENT_TOKEN &&
              !url.includes("/auth") && {
                Authorization: `Bearer ${CURRENT_TOKEN}`,
              }),
          },
          body: body ? JSON.stringify(body) : null,
        };

        // 3. Executa a requisi√ß√£o
        try {
          const response = await fetch(url, options);

          // Requisi√ß√£o DELETE bem-sucedida (Status 204 No Content) n√£o tem corpo JSON
          if (response.status === 204) {
            outputElement.textContent = `Status: 204 No Content\n\nOpera√ß√£o de exclus√£o bem-sucedida.`;
            return;
          }

          // Pega o JSON da resposta (para todos os outros Status)
          const data = await response.json();

          // 4. Exibe a sa√≠da
          outputElement.textContent =
            `Status: ${response.status}\n\n` + JSON.stringify(data, null, 2);

          // Retorna os dados para que as fun√ß√µes chamadoras possam us√°-los (ex: para pegar o ID)
          return data;
        } catch (error) {
          // Erro de rede ou JSON inv√°lido
          outputElement.textContent = "ERRO DE REDE/SERVIDOR: " + error.message;
        }
      }

      // 1. LOGIN
      async function login() {
        const email = document.getElementById("email").value;
        const password = document.getElementById("password").value;
        const outputElement = document.getElementById("auth-output");

        try {
          const response = await fetch(`${BASE_URL}/auth/login`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({ email, password }),
          });

          const data = await response.json();
          outputElement.textContent =
            `Status: ${response.status}\n\n` + JSON.stringify(data, null, 2);

          if (response.ok && data.token) {
            CURRENT_TOKEN = data.token;
            localStorage.setItem("jwtToken", CURRENT_TOKEN);
            document.getElementById("current-token").textContent =
              CURRENT_TOKEN;
            alert("Login bem-sucedido! Token salvo.");
          }
        } catch (error) {
          outputElement.textContent = "ERRO: " + error.message;
        }
      }

      // 2. CRIAR CLIENTE
      async function createCliente() {
        // Pega os novos valores dos campos:
        const nome = document.getElementById("cliente-nome").value;
        const cpf = document.getElementById("cliente-cpf").value;
        const telefone = document.getElementById("cliente-telefone").value; // <--- NOVO
        const email = document.getElementById("cliente-email").value; // <--- NOVO

        const outputElement = document.getElementById("cliente-output");

        const data = await fetchProtected(`${BASE_URL}/clientes`, "POST", {
          nome: nome,
          cpf: cpf,
          telefone: telefone,
          email: email,
        });

        if (data && data.id) {
          CLIENTE_ID = data.id;
          localStorage.setItem("clienteId", CLIENTE_ID);
          document.getElementById("cliente-id").textContent = CLIENTE_ID;

          // Se a se√ß√£o 4 estiver vis√≠vel, atualiza o ID l√° tamb√©m
          document.getElementById("reserva-cliente-id").value = CLIENTE_ID;
        }
      }

      // 3. CRIAR QUARTO
      async function createQuarto() {
        const numero = document.getElementById("quarto-numero").value;
        const valorDiaria = document.getElementById("quarto-valor").value;

        const data = await fetchProtected(`${BASE_URL}/quartos`, "POST", {
          numero: numero,
          tipo: "Duplo", // Hardcoded para simplificar
          valorDiaria: parseFloat(valorDiaria),
          capacidade: 2,
        });

        if (data && data.id) {
          QUARTO_ID = data.id;
          localStorage.setItem("quartoId", QUARTO_ID);
          document.getElementById("quarto-id").textContent = QUARTO_ID;
        }
      }

      // 4. CRIAR RESERVA
      // 5. CRIAR RESERVA (POST /api/reservas)
      async function createReserva() {
        // 1. Coleta e converte os dados imediatamente para garantir que s√£o n√∫meros inteiros
        const clienteId = parseInt(
          document.getElementById("reserva-clienteId").value,
          10
        );
        const quartoId = parseInt(
          document.getElementById("reserva-quartoId").value,
          10
        );
        const dataCheckIn = document.getElementById("reserva-checkIn").value;
        const dataCheckOut = document.getElementById("reserva-checkOut").value;

        // 2. Valida√ß√£o: Checa se os IDs s√£o n√∫meros v√°lidos E se as datas existem
        if (
          isNaN(clienteId) ||
          isNaN(quartoId) ||
          !dataCheckIn ||
          !dataCheckOut
        ) {
          // Mudei a mensagem para ser mais clara sobre a falha no front-end
          alert(
            "ERRO: Por favor, preencha todos os campos, garantindo que os IDs s√£o n√∫meros v√°lidos."
          );
          return;
        }

        // 3. Monta o corpo da requisi√ß√£o (os IDs j√° s√£o n√∫meros aqui)
        const data = {
          clienteId: clienteId,
          quartoId: quartoId,
          dataCheckIn: dataCheckIn,
          dataCheckOut: dataCheckOut,
        };

        // 4. Envia a requisi√ß√£o
        await fetchProtected(`${BASE_URL}/reservas`, "POST", data);
        // Nota: O terceiro argumento n√£o √© necess√°rio na sua fetchProtected, mas o uso dele n√£o prejudica.
      }

      // ... (depois de function createCliente() { ... })

      // 2. LISTAR CLIENTES
      async function listClientes() {
        await fetchProtected(`${BASE_URL}/clientes`, "GET");
        // A sa√≠da (lista de clientes) aparecer√° em <pre id="cliente-output">
      }

      // 3. EDITAR CLIENTE (PUT /api/clientes/:id)
      async function updateCliente() {
        if (!CLIENTE_ID) {
          alert("Crie o Cliente primeiro para obter o ID.");
          return;
        }
        const newEmail = document.getElementById("cliente-email-edit").value;

        await fetchProtected(`${BASE_URL}/clientes/${CLIENTE_ID}`, "PUT", {
          email: newEmail,
          telefone: "888888888", // Novo telefone de teste
        });

        // A sa√≠da (cliente atualizado) aparecer√° em <pre id="cliente-output">
      }

      // 4. EXCLUIR CLIENTE (DELETE /api/clientes/:id)
      async function deleteCliente() {
        if (!CLIENTE_ID) {
          alert("Crie o Cliente primeiro para obter o ID.");
          return;
        }

        const outputElement = document.getElementById("cliente-output");
        outputElement.textContent = "Carregando...";

        // O status 204 (No Content) n√£o retorna JSON, ent√£o tratamos a resposta de forma diferente
        try {
          const url = `${BASE_URL}/clientes/${CLIENTE_ID}`;
          const response = await fetch(url, {
            method: "DELETE",
            headers: { Authorization: `Bearer ${CURRENT_TOKEN}` },
          });

          if (response.status === 204) {
            outputElement.textContent = `Status: 204 No Content\n\nCliente ID ${CLIENTE_ID} exclu√≠do com sucesso.`;
            CLIENTE_ID = "";
            localStorage.removeItem("clienteId");
            document.getElementById("cliente-id").textContent = "N/A";
          } else {
            const data = await response.json();
            outputElement.textContent =
              `Status: ${response.status}\n\n` + JSON.stringify(data, null, 2);
          }
        } catch (error) {
          outputElement.textContent = "ERRO DE REDE/SERVIDOR: " + error.message;
        }
      }

      // NOVO: 3. BUSCAR CLIENTE POR ID (GET /api/clientes/:id)
      async function getOneCliente() {
        const targetId = document.getElementById("cliente-id-input").value;
        if (!targetId) {
          alert("Digite o ID do cliente no campo ID (Para Edi√ß√£o/Excluir).");
          return;
        }

        await fetchProtected(`${BASE_URL}/clientes/${targetId}`, "GET");
      }

      // 4. EDITAR CLIENTE (PUT /api/clientes/:id)
      async function updateCliente() {
        // Pega o ID do campo de input (o ID que ser√° editado)
        const targetId = document.getElementById("cliente-id-input").value;
        if (!targetId) {
          alert(
            "Digite o ID do cliente que voc√™ quer editar no campo ID (Para Edi√ß√£o/Excluir)."
          );
          return;
        }

        // Pega os novos dados dos outros campos
        const nome = document.getElementById("cliente-nome").value;
        const cpf = document.getElementById("cliente-cpf").value;
        const telefone = document.getElementById("cliente-telefone").value;
        const email = document.getElementById("cliente-email").value;

        await fetchProtected(`${BASE_URL}/clientes/${targetId}`, "PUT", {
          nome: nome,
          cpf: cpf,
          telefone: telefone,
          email: email,
        });

        // Atualiza o ID criado/atualizado na tela
        document.getElementById("cliente-id").textContent = targetId;
      }

      // 5. EXCLUIR CLIENTE (DELETE /api/clientes/:id)
      async function deleteCliente() {
        // Pega o ID do campo de input (o ID que ser√° exclu√≠do)
        const targetId = document.getElementById("cliente-id-input").value;
        if (!targetId) {
          alert(
            "Digite o ID do cliente que voc√™ quer excluir no campo ID (Para Edi√ß√£o/Excluir)."
          );
          return;
        }

        const outputElement = document.getElementById("cliente-output");
        outputElement.textContent = "Carregando...";

        try {
          const url = `${BASE_URL}/clientes/${targetId}`;
          const response = await fetch(url, {
            method: "DELETE",
            headers: { Authorization: `Bearer ${CURRENT_TOKEN}` },
          });

          if (response.status === 204) {
            outputElement.textContent = `Status: 204 No Content\n\nCliente ID ${targetId} exclu√≠do com sucesso.`;
          } else {
            const data = await response.json();
            outputElement.textContent =
              `Status: ${response.status}\n\n` + JSON.stringify(data, null, 2);
          }
        } catch (error) {
          outputElement.textContent = "ERRO DE REDE/SERVIDOR: " + error.message;
        }
      }
      async function listQuartos() {
        const status = document.getElementById("quarto-status-filter").value;

        let url = `${BASE_URL}/quartos`;
        if (status) {
          // Adiciona o filtro de status √† URL
          url += `?status=${status}`;
        }

        // A fun√ß√£o fetchProtected usar√° 'quarto-output' para exibir
        await fetchProtected(url, "GET");
      }

      // 4. EDITAR STATUS DO QUARTO (PUT /api/quartos/:id)
      async function updateQuartoStatus() {
        // Pega o ID do quarto que ser√° editado
        const targetId = document.getElementById("quarto-id-input").value;
        // Pega o novo valor do status
        const newStatus = document.getElementById("quarto-status-edit").value;

        if (!targetId) {
          alert("Digite o ID do quarto que voc√™ quer editar no campo ID.");
          return;
        }

        // A requisi√ß√£o PUT para /api/quartos/:id
        await fetchProtected(`${BASE_URL}/quartos/${targetId}`, "PUT", {
          status: newStatus,
        });

        // O resultado (o quarto atualizado) ser√° exibido no painel "quarto-output"
      }

      async function listReservas() {
        // A fun√ß√£o fetchProtected deve usar 'reserva-output'
        await fetchProtected(`${BASE_URL}/reservas`, "GET");
      }

      // ... (fetchProtected e login n√£o mudam)

      // ...

      // 2. CRIAR QUARTO (POST /api/quartos)
      async function createQuarto() {
        const numero = document.getElementById("quarto-numero").value;
        const tipo = document.getElementById("quarto-tipo").value;
        const valorDiaria = document.getElementById("quarto-valor").value;
        const capacidade = document.getElementById("quarto-capacidade").value;
        const status = document.getElementById("quarto-status-edit").value;

        const data = await fetchProtected(`${BASE_URL}/quartos`, "POST", {
          numero: numero,
          tipo: tipo,
          valorDiaria: parseFloat(valorDiaria),
          capacidade: parseInt(capacidade, 10),
          status: status,
        });

        if (data && data.id) {
          QUARTO_ID = data.id;
          localStorage.setItem("quartoId", QUARTO_ID);
          document.getElementById("quarto-id").textContent = QUARTO_ID;
          // Atualiza o ID de input para facilitar o teste de GET/PUT/DELETE
          document.getElementById("quarto-id-input").value = QUARTO_ID;
          // Se a se√ß√£o 4 estiver vis√≠vel, atualiza o ID l√° tamb√©m
          document.getElementById("reserva-quartoId").value = QUARTO_ID;
        }
      }

      // 3. LISTAR QUARTOS (GET /api/quartos?status=...)
      async function listQuartos() {
        // Note que o filtro de status foi removido do HTML atualizado,
        // mas a fun√ß√£o ainda permite o uso se voc√™ o adicionar de volta.
        // Para simplificar, esta vers√£o lista todos.
        await fetchProtected(`${BASE_URL}/quartos`, "GET");
      }

      // 4. BUSCAR QUARTO POR ID (GET /api/quartos/:id)
      async function getOneQuarto() {
        const targetId = document.getElementById("quarto-id-input").value;
        if (!targetId) {
          alert("Digite o ID do quarto no campo ID (Para Edi√ß√£o/Excluir).");
          return;
        }

        await fetchProtected(`${BASE_URL}/quartos/${targetId}`, "GET");
      }

      // 5. ATUALIZAR QUARTO (PUT /api/quartos/:id) - Substitui updateQuartoStatus
      async function updateQuarto() {
        const targetId = document.getElementById("quarto-id-input").value;
        if (!targetId) {
          alert("Digite o ID do quarto que voc√™ quer editar no campo ID.");
          return;
        }

        // Pega todos os dados dos inputs
        const numero = document.getElementById("quarto-numero").value;
        const tipo = document.getElementById("quarto-tipo").value;
        const valorDiaria = document.getElementById("quarto-valor").value;
        const capacidade = document.getElementById("quarto-capacidade").value;
        const newStatus = document.getElementById("quarto-status-edit").value;

        await fetchProtected(`${BASE_URL}/quartos/${targetId}`, "PUT", {
          numero: numero,
          tipo: tipo,
          valorDiaria: parseFloat(valorDiaria),
          capacidade: parseInt(capacidade, 10),
          status: newStatus,
        });

        // Atualiza o ID criado/atualizado na tela
        document.getElementById("quarto-id").textContent = targetId;
      }

      // 6. EXCLUIR QUARTO (DELETE /api/quartos/:id)
      async function deleteQuarto() {
        const targetId = document.getElementById("quarto-id-input").value;
        if (!targetId) {
          alert("Digite o ID do quarto que voc√™ quer excluir no campo ID.");
          return;
        }

        const outputElement = document.getElementById("quarto-output");
        outputElement.textContent = "Carregando...";

        try {
          const url = `${BASE_URL}/quartos/${targetId}`;
          const response = await fetch(url, {
            method: "DELETE",
            headers: { Authorization: `Bearer ${CURRENT_TOKEN}` },
          });

          if (response.status === 204) {
            outputElement.textContent = `Status: 204 No Content\n\nQuarto ID ${targetId} exclu√≠do com sucesso.`;
          } else {
            // Usa fetchProtected para tratar a resposta de erro
            await fetchProtected(url, "DELETE");
          }
        } catch (error) {
          outputElement.textContent = "ERRO DE REDE/SERVIDOR: " + error.message;
        }
      }
      // Remove a fun√ß√£o antiga se ela ainda existir
      // function updateQuartoStatus() { ... }
      // Remova a defini√ß√£o anterior de createReserva (a original)

// Vari√°vel para armazenar o ID da √∫ltima reserva criada/manipulada
let RESERVA_ID = localStorage.getItem("reservaId") || "";
document.getElementById("reserva-id").textContent = RESERVA_ID || "N/A";

// Fun√ß√£o UNIFICADA: 1. Coleta dados, 2. Envia, 3. Salva ID
async function createReserva() {
    // 1. Coleta e converte os dados
    const clienteId = parseInt(
        document.getElementById("reserva-clienteId").value,
        10
    );
    const quartoId = parseInt(
        document.getElementById("reserva-quartoId").value,
        10
    );
    const dataCheckIn = document.getElementById("reserva-checkIn").value;
    const dataCheckOut = document.getElementById("reserva-checkOut").value;

    // 2. Valida√ß√£o: Checa se os IDs s√£o n√∫meros v√°lidos E se as datas existem
    if (
        isNaN(clienteId) ||
        isNaN(quartoId) ||
        !dataCheckIn ||
        !dataCheckOut
    ) {
        alert(
            "ERRO: Por favor, preencha todos os campos, garantindo que os IDs s√£o n√∫meros v√°lidos."
        );
        return;
    }

    // 3. Monta o corpo da requisi√ß√£o
    const data = {
        clienteId: clienteId,
        quartoId: quartoId,
        dataCheckIn: dataCheckIn,
        dataCheckOut: dataCheckOut,
    };

    // 4. Envia a requisi√ß√£o e captura a resposta
    const responseData = await fetchProtected(
        `${BASE_URL}/reservas`,
        "POST",
        data
    );

    // 5. Salva o ID se a requisi√ß√£o foi bem-sucedida
    if (responseData && responseData.id) {
        RESERVA_ID = responseData.id;
        localStorage.setItem("reservaId", RESERVA_ID);
        document.getElementById("reserva-id").textContent = RESERVA_ID;
        // Preenche o campo de input para facilitar o teste de GET/DELETE
        document.getElementById("reserva-id-input").value = RESERVA_ID;
    }
}

// 5. LISTAR RESERVAS (GET /api/reservas)
async function listReservas() {
    await fetchProtected(`${BASE_URL}/reservas`, "GET");
}

// 6. BUSCAR RESERVA POR ID (GET /api/reservas/:id)
async function getOneReserva() {
    const targetId = document.getElementById("reserva-id-input").value;
    if (!targetId) {
        alert("Digite o ID da reserva que voc√™ quer buscar.");
        return;
    }

    await fetchProtected(`${BASE_URL}/reservas/${targetId}`, "GET");
}

// 7. EXCLUIR RESERVA POR ID (DELETE /api/reservas/:id)
async function deleteReserva() {
    // Pega o ID do campo de input
    const targetId = document.getElementById("reserva-id-input").value;
    if (!targetId) {
        alert("Digite o ID da reserva que voc√™ quer excluir.");
        return;
    }

    // A fun√ß√£o fetchProtected j√° trata o status 204 (No Content) corretamente!
    await fetchProtected(`${BASE_URL}/reservas/${targetId}`, "DELETE");

    // Limpa o ID salvo se a exclus√£o for bem-sucedida (melhor esfor√ßo de front-end)
    if (parseInt(targetId, 10) === RESERVA_ID) {
        RESERVA_ID = "";
        localStorage.removeItem("reservaId");
        document.getElementById("reserva-id").textContent = "N/A";
    }
}
    </script>
  </body>
</html>
